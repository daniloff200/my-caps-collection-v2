<div class="detail" *ngIf="cap">
  <div class="detail__back">
    <a routerLink="/" class="detail__back-link">{{ 'DETAIL.BACK' | translate }}</a>
  </div>

  <div class="detail__content">
    <div class="detail__image">
      <img *ngIf="cap.imageUrl" [src]="cap.imageUrl" [alt]="cap.name" />
      <div *ngIf="!cap.imageUrl" class="detail__placeholder">
        <span>üç∫</span>
      </div>
    </div>

    <div class="detail__info">
      <div class="detail__header">
        <h1 class="detail__name">{{ cap.name }}</h1>
        <span *ngIf="cap.forTrade" class="detail__trade-badge">{{ 'DETAIL.FOR_TRADE' | translate }}</span>
        <span *ngIf="cap.needsReplacement" class="detail__replace-badge">{{ 'DETAIL.NEEDS_REPLACEMENT' | translate }}</span>
      </div>

      <div class="detail__meta">
        <div class="detail__meta-item">
          <span class="detail__meta-label">{{ 'DETAIL.COUNTRY' | translate }}</span>
          <span class="detail__meta-value"><app-country-flag [country]="cap.country"></app-country-flag> {{ cap.country }}</span>
        </div>
        <div class="detail__meta-item">
          <span class="detail__meta-label">{{ 'DETAIL.MANUFACTURER' | translate }}</span>
          <span class="detail__meta-value">{{ cap.manufacturer }}</span>
        </div>
        <div class="detail__meta-item">
          <span class="detail__meta-label">{{ 'DETAIL.ADDED' | translate }}</span>
          <span class="detail__meta-value">{{ cap.dateAdded }}</span>
        </div>
      </div>

      <div class="detail__meta-item detail__cci" *ngIf="cap.cciUrl && cciId">
        <span class="detail__meta-label">CrownCaps.info</span>
        <span class="detail__meta-value">
          <a [href]="cap.cciUrl" target="_blank" rel="noopener noreferrer" class="detail__cci-link">#{{ cciId }}</a>
        </span>
      </div>

      <div class="detail__description" *ngIf="cap.description">
        <p>{{ cap.description }}</p>
      </div>

      <div class="detail__tags" *ngIf="cap.tags.length">
        <span class="detail__tags-label">{{ 'DETAIL.TAGS' | translate }}</span>
        <div class="detail__tags-list">
          <app-tag-badge *ngFor="let tag of cap.tags" [tag]="tag"></app-tag-badge>
        </div>
      </div>

      <div class="detail__actions" *ngIf="isAuthenticated">
        <a [routerLink]="['/cap', cap.id, 'edit']" class="btn btn--primary">{{ 'DETAIL.EDIT' | translate }}</a>
        <button class="btn btn--danger" (click)="onDelete()">{{ 'DETAIL.DELETE' | translate }}</button>
      </div>
      <div class="detail__actions-locked" *ngIf="!isAuthenticated">
        <a [routerLink]="['/login']" [queryParams]="{ returnUrl: '/cap/' + cap.id }" class="btn btn--outline">
          üîí {{ 'DETAIL.UNLOCK_TO_EDIT' | translate }}
        </a>
      </div>
    </div>
  </div>
</div>

<div class="loading" *ngIf="loading">
  <p>{{ 'DETAIL.LOADING' | translate }}</p>
</div>

<div class="not-found" *ngIf="!loading && !cap">
  <h2>{{ 'DETAIL.NOT_FOUND' | translate }}</h2>
  <a routerLink="/" class="btn btn--primary">{{ 'DETAIL.BACK_TO_COLLECTION' | translate }}</a>
</div>
